<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Instagram에 로그인</title>
  <link rel="stylesheet" href="../InstaCloneCoding-js/CSS/login.css">
  <link rel="icon" href="../InstaCloneCoding-js/Source/Blue_InstagramLogo.webp"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

</head>
<body>
  <!-- {{{ 로그인 영역 }}} -->
  <div class="loginArea">
    <i class="SG_Instagram">
      <img src="../InstaCloneCoding-js/Source/Logo-Instagram.png" alt="" width="175px">
    </i>
    
    <!-- {{ 아이디,비밀번호 양식 제출 }} -->
    <form action="#" class="login"> 
      <input class="id" type="text" placeholder="전화번호, 사용자 이름 또는 이메일">
      <input class="pwd" type="password" placeholder="비밀번호">
      <button class="loginBtn" disabled="disabled"><a>로그인</a></button>
    </form>

    <div class="or_line">
      <div class="line"></div>
      <div class="text"><p>또는</p></div>
      <div class="line"></div>
    </div>
    <div class="forgotPwd">
      <a href="#" class="">비밀번호를 잊으셨나요?</a>
    </div>
  </div>

  <!-- {{{ 회원가입 영역 }}} -->
  <div class="registerArea">
    <p>계정이 없으신가요? 
      <span class="register">
        <a href="../InstaCloneCoding-js/register.html">가입하기</a>
      </span>
    </p>
  </div>

  </div>

  <!-- <script src="/JS/login.js"></script> -->
  <script>
    const btn = document.querySelector('.loginBtn');
    
    const IdInput = document.querySelector('.id') 
    const PwdInput = document.querySelector('.pwd') 

    function BtnColorChange() {
      // 아이디, 비밀번호란에 입력한 값이 조건에 일치하면 버튼 색상 변경 및, 클릭 가능하게 만들어주는 함수
      const IdText = document.querySelector('.id').value;
      const PwdText = document.querySelector('.pwd').value;
    
      if (IdText.includes('@') && IdText.includes(".com") &&PwdText.length >= 4){
        btn.style.background = "rgb(0, 149, 246, 100)";
        btn.style.cursor = "pointer";
        btn.disabled = false;
      }else{
        btn.style.background = "rgb( 103, 181, 250)";
        btn.disabled = true;
      }
    };
    
    IdInput.addEventListener('input', BtnColorChange);
    PwdInput.addEventListener('input', BtnColorChange);


    btn.addEventListener('click', function (event) {
      event.preventDefault(); // 폼 기본 동작 막기
  
      const email = document.querySelector('.id').value;
      const password = document.querySelector('.pwd').value;
  
      // 로컬 스토리지에서 사용자 데이터 가져오기
      const users = JSON.parse(localStorage.getItem('users')) || [];
      const foundUser = users.find((user) => user.email === email && user.password === password);
  
      if (foundUser) {
          alert(`환영합니다, ${foundUser.name}님!`);
          
          // 현재 로그인한 사용자 정보를 로컬 스토리지에 저장
          localStorage.setItem('currentUser', JSON.stringify(foundUser));
          
          // 메인 페이지로 이동
          window.location.href = '../InstaCloneCoding-js/index.html';
      } else {
          alert('이메일 또는 비밀번호가 일치하지 않습니다.');
      }
  });
  
  </script>

</body>
</html>