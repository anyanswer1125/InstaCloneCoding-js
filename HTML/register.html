<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Instagram에 가입하기</title>
  <link rel="stylesheet" href="../CSS/register.css">

</head>
<body>
  <!-- {{{ 로그인 영역 }}} -->
  <div class="RegisterArea">
    <i class="SG_Instagram">
      <img src="../Source/Logo-Instagram.png" alt="" width="175px">
    </i>

    <p class="friend">친구들의 사진과 동영상을 보려면 가입하세요.</p>
    
    <!-- {{ 아이디,비밀번호 양식 제출 }} -->
    <form action="#" class="Register"> 
      <input class="id" type="text" placeholder="휴대폰 번호 또는 이메일 주소">
      <input class="pwd" type="password" placeholder="비밀번호">
      <input class="name" type="text" placeholder="성명">
      <input class="username" type="text" placeholder="사용자 이름">
      <button class="RegisterBtn"><a>가입</a></button>
    </form>

    <div class="or_line">
      <div class="line"></div>
      <div class="text"><p>또는</p></div>
      <div class="line"></div>
    </div>
    <div class="forgotPwd">
      <a href="#" class="">게스트로 이용하기</a>
    </div>
  </div>

  <!-- {{{ 회원가입 영역 }}} -->
  <div class="LoginArea">
    <p>계정이 있으신가요?
      <span class="Login">
        <a href="../HTML/login.html">로그인</a>
      </span>
    </p>
  </div>

  </div>

  <!-- <script src="/JS/register.js">  </script> -->

  <script>
    const btn = document.querySelector('.RegisterBtn');

    const IdInput = document.querySelector('.id') 
    const PwdInput = document.querySelector('.pwd') 
    const nameInput = document.querySelector('.name');
    const usernameInput = document.querySelector('.username');
    
    function BtnColorChange() {
      // 아이디, 비밀번호란에 입력한 값이 조건에 일치하면 버튼 색상 변경 및, 클릭 가능하게 만들어주는 함수
      const IdText = document.querySelector('.id').value;
      const PwdText = document.querySelector('.pwd').value;
      const nameText = document.querySelector('.name').value;
      const usernameText = document.querySelector('.username').value;
    
      if (IdText.includes('@') && 
      IdText.includes(".com") &&
      nameText.length >= 1 &&
      usernameText.length >= 1 &&
      PwdText.length >= 4){
        btn.style.background = "rgb(0, 149, 246, 100)";
        btn.style.cursor = "pointer";
      }else{
        btn.style.background = "rgb( 103, 181, 250)";
        btn.style.cursor = "default";
      }
    };
    
    IdInput.addEventListener('input', BtnColorChange);
    PwdInput.addEventListener('input', BtnColorChange);
    nameInput.addEventListener('input', BtnColorChange)
    usernameInput.addEventListener('input', BtnColorChange)

  btn.addEventListener('click', function (event) {
    event.preventDefault(); // 폼 기본 동작 막기

    const email = document.querySelector('.id').value;
    const password = document.querySelector('.pwd').value;
    const name = document.querySelector('.name').value;
    const username = document.querySelector('.username').value;

    // 유효성 검사
    if (!email.includes('@') || !email.includes('.com') || password.length < 4 || name.length < 1 || username.length < 1) {
      alert('모든 필드를 올바르게 입력해주세요.');
      return;
    }

    // 사용자 데이터 객체 생성
    const user = {
      email,
      password,
      name,
      username,
    };

    // 로컬 스토리지에 저장
    const users = JSON.parse(localStorage.getItem('users')) || [];
    const isExistingUser = users.some((u) => u.email === email);

    if (isExistingUser) {
      alert('이미 가입된 이메일입니다.');
    } else {
      users.push(user);
      localStorage.setItem('users', JSON.stringify(users));
      alert('회원가입 성공! 이제 로그인하세요.');
      window.location.href = '../HTML/login.html'; // 로그인 페이지로 이동
    }
  });
</script>

</body>
</html>